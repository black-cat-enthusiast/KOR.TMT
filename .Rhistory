)
knitr::kable(c)
# Chunk 17
# Time spent in to the closed arm (seconds)
# Run Oneway ANOVA
oneway.test(Closed_Tm ~ TMT, data = data, var.equal = TRUE)
get_anova_table(a)
# Run follow-up comparisons
c <- data %>%
pairwise_t_test(
Closed_Tm ~ Drug, paired = FALSE,
p.adjust.method = "bonferroni"
)
knitr::kable(c)
# Enteries into the closed arm (number)
# Run Oneway ANOVA
oneway.test(Closed_Freq ~ TMT, data = data, var.equal = TRUE)
get_anova_table(a)
# Run follow-up comparisons
c <- data %>%
pairwise_t_test(
Closed_Freq ~ Drug, paired = FALSE,
p.adjust.method = "bonferroni"
)
knitr::kable(c)
# Chunk 18
# Make "exploratory index"
data$exp_index <- (data$Open_Tm*data$Open_Freq) / (data$Closed_Tm*data$Closed_Freq)
# Run Oneway ANOVA
oneway.test(exp_index ~ TMT, data = data, var.equal = TRUE)
get_anova_table(a)
# Run follow-up comparisons
c <- data %>%
pairwise_t_test(
exp_index ~ Drug, paired = FALSE,
p.adjust.method = "bonferroni"
)
knitr::kable(c)
# Chunk 1
## Load Packages
library(tidyverse)
library(ggpubr)
library(reshape2)
library(png)
library(rstatix)
# Chunk 2
# Get long after freezing data
TwoWeeksFrz_data <- read_csv("Data/BL_Frz_Nov15.csv")
TwoWeeksFrz_data$Drug <- as.character(TwoWeeksFrz_data$Drug)
TwoWeeksFrz_data$Drug <- factor(TwoWeeksFrz_data$Drug, levels = unique(TwoWeeksFrz_data$Drug))
train_data <- read_csv("Data/Train_Oct25.csv")
train_data$Perc <- (train_data$Frz_Tm / 250)*100
train_data$Drug <- as.character(train_data$Drug)
train_data$Drug <- factor(train_data$Drug, levels = unique(train_data$Drug))
train_data <- train_data %>%
mutate(Av_Dur = Frz_Tm / Frz_Freq)
train_data$Task <- case_match(train_data$Task,
"Neutral" ~ "Baseline",
"Neutral side" ~ "Neutral side",
"TMT side" ~ "TMT side")
ALL_frz_Data <- rbind(train_data,TwoWeeksFrz_data)
ALL_frz_Data$Task <- as.character(ALL_frz_Data$Task)
ALL_frz_Data$Task <- factor(ALL_frz_Data$Task,levels=c("Baseline","TMT","TMT side","Neutral side"))
OG_baseline_data <- train_data[train_data$Task == "Baseline", ]
All_baseline_data <- rbind(OG_baseline_data, TwoWeeksFrz_data) %>%
filter(ID != 35)
TwoWeeksFrz_data <- TwoWeeksFrz_data %>%
filter(ID != 35)
# Chunk 3
# Time Spent Freezing (Percent)
a <- TwoWeeksFrz_data %>%
group_by(Drug,Task)%>%
summarise(
n=n(),
mean=mean(Perc),
sd=sd(Perc)
) %>%
mutate(se=sd/sqrt(n)) %>%
ggplot(aes(x=Drug,y=mean,colour=Drug,fill=Drug))+
geom_bar(stat="identity",alpha=0.5,colour=NA)+
geom_errorbar(aes(x=Drug,ymin=mean-se,ymax=mean+se),width=0.5)+
scale_colour_manual(values=c("#367588","#88250A"))+
scale_fill_manual(values=c("#367588","#88250A"))+
theme_classic()+
facet_wrap(~Task,ncol=4)+
theme(plot.title=element_text(hjust=0.5))+
theme(legend.position = "none")+
theme(axis.text.x = element_text(angle = 45, hjust=1))+
labs(x="",
y="% Freezing")+
ylim(0,50)
x <- data.frame(Drug = c("Saline","Saline"),
Task = c("Neutral side","TMT side"),
end = c("Nor-BNI","Nor-BNI"),
y = c(100,30),
label = c("p=0.06","***"))
x$Drug <- as.character(x$Drug)
x$Drug <- factor(x$Drug,labels=unique(x$Drug))
A <- a +
geom_jitter(data = TwoWeeksFrz_data, aes(x=Drug,y=Perc,shape=Drug),size=1,alpha=0.3,width=0.15,height=0)+
geom_signif(data = x,
aes(xmin = Drug, xmax = end, annotations = label, y_position = y),colour="black",manual = TRUE)
b <- All_baseline_data %>%
group_by(Drug,Task)%>%
summarise(
n=n(),
mean=mean(Perc),
sd=sd(Perc)
) %>%
mutate(se=sd/sqrt(n)) %>%
ggplot(aes(x=Task,y=mean,group=Drug,shape=Drug,colour=Drug,group=Drug))+
geom_point(size=3,alpha=0.8)+
geom_line(size=1)+
geom_errorbar(aes(x=Task,ymin=mean-se,ymax=mean+se),width=1,alpha=0.8)+
scale_colour_manual(values=c("#367588","#88250A"))+
facet_wrap(~Drug)+
theme_classic()+
theme(legend.position="none")+
theme(axis.text.x = element_text(angle = 45, hjust=1))+
theme(axis.text.x = element_text(angle = 45, hjust=1))+
labs(x="",y="% Freezing")+
ylim(0,50)
x <- data.frame(Task = c("Baseline","Baseline"),
Drug = c("Saline","Nor-BNI"),
end = c("Neutral side","Neutral side"),
y = c(40,40),
label = c("***","***"))
y <- data.frame(Task = c("Neutral side","Neutral side"),
Drug = c("Saline","Nor-BNI"),
end = c("TMT side","TMT side"),
y = c(55,25),
label = c("n.s.","**"))
x$Drug <- as.character(x$Drug)
x$Drug <- factor(x$Drug,labels=unique(x$Drug))
y$Drug <- as.character(x$Drug)
y$Drug <- factor(y$Drug,labels=unique(y$Drug))
B <- b +
geom_line(data=All_baseline_data, aes(x=Task,y=Perc,group=ID,colour=Drug),size=0.4,alpha=0.2)+
scale_colour_manual(values=c("#367588","#88250A"))+
geom_signif(data = x,
aes(xmin = Task, xmax = end, annotations = label, y_position = y),colour="black",manual = TRUE)+
geom_signif(data = y,
aes(xmin = Task, xmax = end, annotations = label, y_position = y),colour="black",manual = TRUE)
c <- All_baseline_data %>%
filter(Task != "Baseline") %>%
select("ID","Task","Expt","Drug","Perc") %>%
dcast(ID+Drug~Task) %>%
mutate(change = `TMT side` - `Neutral side`) %>%
filter(change <45)
C <- c %>%
group_by(Drug) %>%
summarise(
n=n(),
mean=mean(change),
sd=sd(change)
) %>% mutate(se = sd / sqrt(n)) %>%
ggplot(aes(x=Drug,y=mean,colour=Drug,fill=Drug))+
geom_bar(stat="identity",alpha=0.5,colour=NA)+
geom_errorbar(aes(x=Drug,ymin=mean-se,ymax=mean+se),width=0.5)+
scale_colour_manual(values=c("#367588","#88250A"))+
scale_fill_manual(values=c("#367588","#88250A"))+
theme_classic()+
theme(legend.position = "none")+
theme(axis.text.x = element_text(angle = 45, hjust=1))+
labs(x="",y=expression(Delta~"% Freezing"))+
geom_jitter(data=c,aes(x=Drug,y=change,shape=Drug),size=1,alpha=0.3,width=0.25)+
geom_hline(yintercept=0,alpha=0.5)+
geom_signif(y_position=20,xmin=1,xmax=2,
annotations="*",tip_length=0.02,colour="black")+
ylim(-25,25)
# Chunk 4
# Number of freezes
a <- TwoWeeksFrz_data %>%
group_by(Drug,Task)%>%
summarise(
n=n(),
mean=mean(Frz_Freq),
sd=sd(Frz_Freq)
) %>%
mutate(se=sd/sqrt(n)) %>%
ggplot(aes(x=Drug,y=mean,colour=Drug,fill=Drug))+
geom_bar(stat="identity",alpha=0.5,colour=NA)+
geom_errorbar(aes(x=Drug,ymin=mean-se,ymax=mean+se),width=0.5)+
scale_colour_manual(values=c("#367588","#88250A"))+
scale_fill_manual(values=c("#367588","#88250A"))+
theme_classic()+
facet_wrap(~Task,ncol=4)+
theme(plot.title=element_text(hjust=0.5))+
theme(legend.position = "none")+
theme(axis.text.x = element_text(angle = 45, hjust=1))+
labs(x="",
y="Freezing Frequency")+
ylim(0,150)
x <- data.frame(Drug = c("Saline","Saline"),
Task = c("Neutral side","TMT side"),
end = c("Nor-BNI","Nor-BNI"),
y = c(200,100),
label = c("n.s.","***"))
x$Drug <- as.character(x$Drug)
x$Drug <- factor(x$Drug,labels=unique(x$Drug))
D <- a + geom_jitter(data = TwoWeeksFrz_data, aes(x=Drug,y=Frz_Freq,shape=Drug),size=1,alpha=0.3,width=0.15,height=0)+
geom_signif(data = x,
aes(xmin = Drug, xmax = end, annotations = label, y_position = y),colour="black",manual = TRUE)
e <- All_baseline_data %>%
group_by(Drug,Task)%>%
summarise(
n=n(),
mean=mean(Frz_Freq),
sd=sd(Frz_Freq)
) %>%
mutate(se=sd/sqrt(n)) %>%
ggplot(aes(x=Task,y=mean,group=Drug,shape=Drug,colour=Drug,group=Drug))+
geom_point(size=3,alpha=0.8)+
geom_line(size=1)+
geom_errorbar(aes(x=Task,ymin=mean-se,ymax=mean+se),width=1,alpha=0.8)+
scale_colour_manual(values=c("#367588","#88250A"))+
facet_wrap(~Drug)+
theme_classic()+
theme(legend.position="none")+
theme(axis.text.x = element_text(angle = 45, hjust=1))+
labs(x="",y="Freezing Frequency")+
ylim(0,125)
x <- data.frame(Task = c("Baseline","Baseline"),
Drug = c("Saline","Nor-BNI"),
end = c("Neutral side","Neutral side"),
y = c(110,110),
label = c("***","***"))
y <- data.frame(Task = c("Neutral side","Neutral side"),
Drug = c("Saline","Nor-BNI"),
end = c("TMT side","TMT side"),
y = c(200,100),
label = c("n.s.","***"))
x$Drug <- as.character(x$Drug)
x$Drug <- factor(x$Drug,labels=unique(x$Drug))
y$Drug <- as.character(x$Drug)
y$Drug <- factor(y$Drug,labels=unique(y$Drug))
E <- e +
geom_line(data=All_baseline_data, aes(x=Task,y=Frz_Freq,group=ID,colour=Drug),size=0.4,alpha=0.2)+
scale_colour_manual(values=c("#367588","#88250A"))+
geom_signif(data = x,
aes(xmin = Task, xmax = end, annotations = label, y_position = y),colour="black",manual = TRUE)+
geom_signif(data = y,
aes(xmin = Task, xmax = end, annotations = label, y_position = y),colour="black",manual = TRUE)
OG_baseline_data <- train_data[train_data$Task == "Baseline", ]
All_baseline_data <- rbind(OG_baseline_data, TwoWeeksFrz_data)
c <- All_baseline_data %>%
filter(Task != "Baseline") %>%
select("ID","Task","Expt","Drug","Frz_Freq") %>%
dcast(ID+Drug~Task) %>%
mutate(change = `TMT side` - `Neutral side`) %>%
filter(change <35)
F <- c %>%
group_by(Drug) %>%
summarise(
n=n(),
mean=mean(change),
sd=sd(change)
) %>% mutate(se = sd / sqrt(n)) %>%
ggplot(aes(x=Drug,y=mean,colour=Drug,fill=Drug))+
geom_bar(stat="identity",alpha=0.5,colour=NA)+
geom_errorbar(aes(x=Drug,ymin=mean-se,ymax=mean+se),width=0.5)+
scale_colour_manual(values=c("#367588","#88250A"))+
scale_fill_manual(values=c("#367588","#88250A"))+
theme_classic()+
theme(legend.position = "none")+
theme(axis.text.x = element_text(angle = 45, hjust=1))+
labs(x="",y=expression(Delta~"Frequency"))+
geom_jitter(data=c,aes(x=Drug,y=change,shape=Drug),size=1,alpha=0.3,width=0.25)+
geom_hline(yintercept=0,alpha=0.5)+
geom_signif(y_position=10,xmin=1,xmax=2,
annotations="*",tip_length=0.02,colour="black")
# Chunk 5
# Average Duation
a <- TwoWeeksFrz_data %>%
group_by(Drug,Task)%>%
summarise(
n=n(),
mean=mean(Av_Dur),
sd=sd(Av_Dur)
) %>%
mutate(se=sd/sqrt(n)) %>%
ggplot(aes(x=Drug,y=mean,colour=Drug,fill=Drug))+
geom_bar(stat="identity",alpha=0.5,colour=NA)+
geom_errorbar(aes(x=Drug,ymin=mean-se,ymax=mean+se),width=0.5)+
scale_colour_manual(values=c("#367588","#88250A"))+
scale_fill_manual(values=c("#367588","#88250A"))+
theme_classic()+
facet_wrap(~Task,ncol=4)+
theme(plot.title=element_text(hjust=0.5))+
theme(legend.position = "none")+
theme(axis.text.x = element_text(angle = 45, hjust=1))+
labs(x="",
y="Average Freeze (s)")+
ylim(0,2)
x <- data.frame(Drug = c("Saline","Saline"),
Task = c("Neutral side","TMT side"),
end = c("Nor-BNI","Nor-BNI"),
y = c(1.5,1.5),
label = c("***","***"))
x$Drug <- as.character(x$Drug)
x$Drug <- factor(x$Drug,labels=unique(x$Drug))
G <- a + geom_jitter(data = TwoWeeksFrz_data, aes(x=Drug,y=Av_Dur,shape=Drug),size=1,alpha=0.3,width=0.15,height=0)+
geom_signif(data = x,
aes(xmin = Drug, xmax = end, annotations = label, y_position = y),colour="black",manual = TRUE)
e <- All_baseline_data %>%
group_by(Drug,Task)%>%
summarise(
n=n(),
mean=mean(Av_Dur),
sd=sd(Av_Dur)
) %>%
mutate(se=sd/sqrt(n)) %>%
ggplot(aes(x=Task,y=mean,group=Drug,shape=Drug,colour=Drug,group=Drug))+
geom_point(size=3,alpha=0.8)+
geom_line(size=1)+
geom_errorbar(aes(x=Task,ymin=mean-se,ymax=mean+se),width=1,alpha=0.8)+
scale_colour_manual(values=c("#367588","#88250A"))+
facet_wrap(~Drug)+
theme_classic()+
theme(legend.position="none")+
theme(axis.text.x = element_text(angle = 45, hjust=1))+
labs(x="",y="Average Freeze (s)")+
ylim(0,2)
H <- e +
geom_line(data=All_baseline_data, aes(x=Task,y=Av_Dur,group=ID,colour=Drug),size=0.4,alpha=0.2)+
scale_colour_manual(values=c("#367588","#88250A"))
OG_baseline_data <- train_data[train_data$Task == "Baseline", ]
All_baseline_data <- rbind(OG_baseline_data, TwoWeeksFrz_data)
c <- All_baseline_data %>%
filter(Task != "Baseline") %>%
select("ID","Task","Expt","Drug","Av_Dur") %>%
dcast(ID+Drug~Task) %>%
mutate(change = `TMT side` - `Neutral side`) %>%
filter(change <35)
I <- c %>%
group_by(Drug) %>%
summarise(
n=n(),
mean=mean(change),
sd=sd(change)
) %>% mutate(se = sd / sqrt(n)) %>%
ggplot(aes(x=Drug,y=mean,colour=Drug,fill=Drug))+
geom_bar(stat="identity",alpha=0.5,colour=NA)+
geom_errorbar(aes(x=Drug,ymin=mean-se,ymax=mean+se),width=0.5)+
scale_colour_manual(values=c("#367588","#88250A"))+
scale_fill_manual(values=c("#367588","#88250A"))+
theme_classic()+
theme(legend.position = "none")+
theme(axis.text.x = element_text(angle = 45, hjust=1))+
labs(x="",y=expression(Delta~"Average Freeze (s)"))+
geom_jitter(data=c,aes(x=Drug,y=change,shape=Drug),size=1,alpha=0.3,width=0.25)+
geom_hline(yintercept=0,alpha=0.5)+
geom_signif(y_position=2,xmin=1,xmax=2,
annotations="*",tip_length=0.02,colour="black")+
ylim(-0.5,0.5)
# Chunk 6
# Correlations
J <- TwoWeeksFrz_data %>%
group_by(Drug) %>%
ggplot(aes(x=Frz_Freq,y=Perc,colour=Drug,shape=Drug,fill=Drug))+
geom_point(size=5,alpha=0.5,colour=NA)+
geom_smooth(method="lm",alpha=0.5)+
scale_colour_manual(values=c("#367588","#88250A"))+
scale_fill_manual(values=c("#367588","#88250A"))+
facet_wrap(~Task)+
theme_classic()+
theme(legend.position=c(0,1),legend.justification = c(0,1))+
labs(x="Freezing Frequency",
y="% Freezing",
colour=NULL,shape=NULL,fill=NULL)+
ylim(0,70)
K <- TwoWeeksFrz_data %>%
group_by(Drug) %>%
ggplot(aes(x=Av_Dur,y=Perc,colour=Drug,shape=Drug,fill=Drug))+
geom_point(size=5,alpha=0.5,colour=NA)+
geom_smooth(method="lm",alpha=0.5)+
scale_colour_manual(values=c("#367588","#88250A"))+
scale_fill_manual(values=c("#367588","#88250A"))+
facet_wrap(~Task)+
theme_classic()+
theme(legend.position=c(0,1),legend.justification = c(0,1))+
labs(x="Average Duration of Freezing Episode (s)",
y="% Freezing",
colour=NULL,shape=NULL,fill=NULL)+
ylim(0,70)
# Chunk 7
cartoon <- readPNG("Cartoons/GPs_LONG.png")
AA <- ggplot () +
background_image(cartoon)+
coord_fixed(0.2)
BB <- ggplot()+
theme_void()
top <- ggarrange(A,B,C,
nrow=1,ncol=3,
labels = c("B","C","D"),
widths = c(0.9,1,0.5))
middle <- ggarrange(D,E,F,
nrow=1,ncol=3,
labels=c("E","F","G"),
widths = c(0.9,1,0.5))
panel <- ggarrange(AA,top,middle,
nrow=3,ncol=1,heights=c(2,3,3,3),
labels=c("A"))+
theme(panel.background = element_rect(fill="#FFFFFF",colour="#FFFFFF"))+
theme(plot.background = element_rect(fill = "#FFFFFF", colour="#FFFFFF"))
ggsave("Panels/5_Long_Panel.png",panel,height=6.5,width=5.5,dpi=300)
ggsave("Panels/tiffs/5_Long_panel.tiff",panel,height=6.5,width=5.5,dpi=500,device=tiff)
# Chunk 8
knitr::include_graphics("Panels/5_Long_Panel.png")
# Chunk 9
# Analyze Time spent freezing (percent) first
c <- All_baseline_data %>%
filter(Task != "Baseline") %>%
select("ID","Task","Expt","Drug","Frz_Tm") %>%
dcast(ID+Drug~Task) %>%
mutate(change = `TMT side` - `Neutral side`)
d <- c %>%
select("ID","Drug",`Neutral side`, `TMT side`) %>%
melt(id.vars=(c("ID","Drug")))
a <- anova_test(data=d, dv=value, wid=ID, within = variable, between = Drug)
knitr::kable(get_anova_table(a))
# Chunk 10
e <- d %>%
group_by(variable)%>%
pairwise_t_test(
value ~ Drug, paired = FALSE,
p.adjust.method = "bonferroni"
)
knitr::kable(e)
# Chunk 11
f <- d %>%
group_by(Drug)%>%
pairwise_t_test(
value ~ variable, paired = TRUE,
p.adjust.method = "bonferroni"
)
knitr::kable(f)
# Chunk 12
t.test(change~Drug,data=c)
# Chunk 13
# Analyze Time spent freezing (percent) first
c <- All_baseline_data %>%
filter(Task != "Baseline") %>%
select("ID","Task","Expt","Drug","Frz_Freq") %>%
dcast(ID+Drug~Task) %>%
mutate(change = `TMT side` - `Neutral side`)
d <- c %>%
select("ID","Drug",`Neutral side`, `TMT side`) %>%
melt(id.vars=(c("ID","Drug")))
a <- anova_test(data=d, dv=value, wid=ID, within = variable, between = Drug)
knitr::kable(get_anova_table(a))
# Chunk 14
e <- d %>%
group_by(variable)%>%
pairwise_t_test(
value ~ Drug, paired = FALSE,
p.adjust.method = "bonferroni"
)
knitr::kable(e)
# Chunk 15
f <- d %>%
group_by(Drug)%>%
pairwise_t_test(
value ~ variable, paired = TRUE,
p.adjust.method = "bonferroni"
)
knitr::kable(f)
# Chunk 16
t.test(change~Drug,data=c)
# Chunk 17
# Analyze Av_Dur
c <- All_baseline_data %>%
filter(Task != "Baseline") %>%
select("ID","Task","Expt","Drug","Av_Dur") %>%
dcast(ID+Drug~Task) %>%
mutate(change = `TMT side` - `Neutral side`)
d <- c %>%
select("ID","Drug",`Neutral side`, `TMT side`) %>%
melt(id.vars=(c("ID","Drug")))
a <- anova_test(data=d, dv=value, wid=ID, within = variable, between = Drug)
knitr::kable(get_anova_table(a))
# Chunk 18
e <- d %>%
group_by(variable)%>%
pairwise_t_test(
value ~ Drug, paired = FALSE,
p.adjust.method = "bonferroni"
)
knitr::kable(e)
# Chunk 19
f <- d %>%
group_by(Drug)%>%
pairwise_t_test(
value ~ variable, paired = TRUE,
p.adjust.method = "bonferroni"
)
knitr::kable(f)
# Chunk 20
# A regression model
a <- lm(Perc~Frz_Freq * Drug + Task, data=TwoWeeksFrz_data)
summary(a)
# Re-order the "drug" variable to get the intercept for the NorBNI group.
b <- TwoWeeksFrz_data
b$Drug <- as.character(b$Drug)
b$Drug <- factor(b$Drug,levels = c("Nor-BNI","Saline"))
# A different version of the same regression model
a <- lm(Perc~Frz_Freq * Drug + Task, data=b)
summary(a)
# Chunk 21
# Model 2: X=Av_Dur, y=Perc
a <- lm(Perc~Av_Dur * Drug + Task, data=TwoWeeksFrz_data)
summary(a)
